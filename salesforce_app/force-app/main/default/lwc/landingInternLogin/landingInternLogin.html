<template>
    <div class="login-container">
        <!-- Animated Background -->
        <div class="background-animation">
            <div class="floating-shape shape-1"></div>
            <div class="floating-shape shape-2"></div>
            <div class="floating-shape shape-3"></div>
            <div class="floating-shape shape-4"></div>
            <div class="gradient-overlay"></div>
        </div>


        <!-- Main Card -->
        <div class={cardClass}>
            <!-- Back to Home (Top-Left Inside Card) -->
            <div class="card-back-button">
                <button class="small-back-button" onclick={handleBackToLanding}>
                    <lightning-icon icon-name="utility:back" size="xx-small" class="button-icon"></lightning-icon>
                    <span>Back to Home</span>
                </button>
            </div>

            <!-- Logo & Header -->
            <div class="login-header">
                <div class="logo-wrapper">
                    <lightning-icon icon-name="standard:portal" size="large" class="intern-logo">
                    </lightning-icon>
                </div>
                <h1 class="main-title">{headerTitle}</h1>
                <p class="subtitle">{subtitle}</p>
                <div class="divider"></div>
            </div>

            <!-- Error Message -->
            <template if:true={error}>
                <div class="error-alert">
                    <lightning-icon icon-name="utility:warning" size="x-small" class="error-icon">
                    </lightning-icon>
                    <span class="error-text">{error}</span>
                </div>
            </template>

            <!-- Success Message -->
            <template if:true={successMessage}>
                <div class="success-alert">
                    <lightning-icon icon-name="utility:success" size="x-small" class="success-icon">
                    </lightning-icon>
                    <span class="success-text">{successMessage}</span>
                </div>
            </template>

            <!-- LOGIN VIEW -->
            <template if:true={isLoginView}>
                <form class="login-form" onsubmit={handleFormSubmit}>
                    <div class="input-wrapper">
                        <div class="input-icon">
                            <lightning-icon icon-name="utility:email" size="x-small"></lightning-icon>
                        </div>
                        <input type="email" placeholder="student@college.edu" value={email} oninput={handleLoginInput}
                            data-id="email" required class="modern-input" />
                    </div>

                    <div class="input-wrapper">
                        <div class="input-icon">
                            <lightning-icon icon-name="utility:lock" size="x-small"></lightning-icon>
                        </div>
                        <input type="password" placeholder="Enter your password" value={password}
                            oninput={handleLoginInput} data-id="password" required class="modern-input" />
                    </div>

                    <div class="footer-links">
                        <a href="javascript:void(0);" onclick={showRegister} class="link-item">New Register?</a>
                        <a href="javascript:void(0);" onclick={showForgot} class="link-item">Forget Your Password?</a>
                    </div>

                    <button type="submit" class="primary-button" disabled={isLoading}>
                        <template if:false={isLoading}>
                            <lightning-icon icon-name="utility:login" size="x-small"
                                class="button-icon"></lightning-icon>
                            <span>Login</span>
                        </template>
                        <template if:true={isLoading}>
                            <span>Signing In...</span>
                        </template>
                    </button>
                </form>
            </template>

            <!-- REGISTER VIEW -->
            <template if:true={isRegisterView}>
                <form class="login-form register-form" onsubmit={handleFormSubmit}>
                    <div class="form-grid">
                        <!-- First Name -->
                        <div class="input-wrapper">
                            <div class="input-icon">
                                <lightning-icon icon-name="utility:user" size="x-small"></lightning-icon>
                            </div>
                            <input type="text" placeholder="John" value={regData.firstName}
                                oninput={handleRegisterInput} data-id="firstName" required class="modern-input" />
                        </div>

                        <!-- Last Name -->
                        <div class="input-wrapper">
                            <div class="input-icon">
                                <lightning-icon icon-name="utility:user" size="x-small"></lightning-icon>
                            </div>
                            <input type="text" placeholder="Doe" value={regData.lastName} oninput={handleRegisterInput}
                                data-id="lastName" required class="modern-input" />
                        </div>

                        <!-- Email -->
                        <div class="input-wrapper">
                            <div class="input-icon">
                                <lightning-icon icon-name="utility:email" size="x-small"></lightning-icon>
                            </div>
                            <input type="email" placeholder="student@college.edu" value={regData.email}
                                oninput={handleRegisterInput} data-id="email" required class="modern-input" />
                        </div>

                        <!-- Phone -->
                        <div class="input-wrapper">
                            <div class="input-icon">
                                <lightning-icon icon-name="utility:phone_portrait" size="x-small"></lightning-icon>
                            </div>
                            <input type="tel" placeholder="+1 234 567 8900" value={regData.phone}
                                oninput={handleRegisterInput} data-id="phone" required class="modern-input" />
                        </div>

                        <!-- College Name -->
                        <div class="input-wrapper full-width">
                            <div class="input-icon">
                                <lightning-icon icon-name="utility:education" size="x-small"></lightning-icon>
                            </div>
                            <input type="text" placeholder="Your University" value={regData.college}
                                oninput={handleRegisterInput} data-id="college" required class="modern-input" />
                        </div>

                        <!-- Roll Number -->
                        <div class="input-wrapper full-width">
                            <div class="input-icon">
                                <lightning-icon icon-name="utility:number_input" size="x-small"></lightning-icon>
                            </div>
                            <input type="text" placeholder="Student ID / Roll Number" value={regData.rollNo}
                                oninput={handleRegisterInput} data-id="rollNo" required class="modern-input" />
                        </div>

                        <!-- Address -->
                        <div class="input-wrapper full-width">
                            <div class="input-icon">
                                <lightning-icon icon-name="utility:location" size="x-small"></lightning-icon>
                            </div>
                            <input type="text" placeholder="Your Address" value={regData.address}
                                oninput={handleRegisterInput} data-id="address" required class="modern-input" />
                        </div>

                        <!-- Password -->
                        <div class="input-wrapper full-width">
                            <div class="input-icon">
                                <lightning-icon icon-name="utility:lock" size="x-small"></lightning-icon>
                            </div>
                            <input type="password" placeholder="Create a strong password" value={regData.password}
                                oninput={handleRegisterInput} data-id="password" required class="modern-input" />
                        </div>
                    </div>

                    <button type="submit" class="primary-button" disabled={isLoading}>
                        <template if:false={isLoading}>
                            <lightning-icon icon-name="utility:adduser" size="x-small"
                                class="button-icon"></lightning-icon>
                            <span>Sign Up</span>
                        </template>
                        <template if:true={isLoading}>
                            <span>Creating Account...</span>
                        </template>
                    </button>

                    <div class="separator">
                        <span>Already have an account?</span>
                    </div>

                    <button type="button" class="secondary-button" onclick={showLogin}>
                        <lightning-icon icon-name="utility:back" size="x-small" class="button-icon"></lightning-icon>
                        <span>Back to Login</span>
                    </button>
                </form>
            </template>

            <!-- FORGOT PASSWORD VIEW -->
            <template if:true={isForgotView}>
                <template if:false={isForgotSuccess}>
                    <form class="login-form" onsubmit={handleFormSubmit}>
                        <div class="input-wrapper">
                            <div class="input-icon">
                                <lightning-icon icon-name="utility:email" size="x-small"></lightning-icon>
                            </div>
                            <input type="email" placeholder="student@college.edu" value={forgotEmail}
                                oninput={handleForgotInput} data-id="email" required class="modern-input" />
                        </div>

                        <div class="input-wrapper">
                            <div class="input-icon">
                                <lightning-icon icon-name="utility:education" size="x-small"></lightning-icon>
                            </div>
                            <input type="text" placeholder="Your University" value={forgotCollege}
                                oninput={handleForgotInput} data-id="college" required class="modern-input" />
                        </div>

                        <button type="submit" class="primary-button" disabled={isLoading}>
                            <template if:false={isLoading}>
                                <lightning-icon icon-name="utility:send" size="x-small"
                                    class="button-icon"></lightning-icon>
                                <span>Submit Request</span>
                            </template>
                            <template if:true={isLoading}>
                                <span>Sending...</span>
                            </template>
                        </button>

                        <div class="separator">
                            <span>Remember password?</span>
                        </div>

                        <button type="button" class="secondary-button" onclick={showLogin}>
                            <lightning-icon icon-name="utility:back" size="x-small"
                                class="button-icon"></lightning-icon>
                            <span>Back to Login</span>
                        </button>
                    </form>
                </template>

                <!-- Success State for Forgot Password -->
                <template if:true={isForgotSuccess}>
                    <div class="success-state">
                        <div class="success-icon-large">
                            <lightning-icon icon-name="utility:success" size="large"></lightning-icon>
                        </div>
                        <h2 class="success-title">Request Sent!</h2>
                        <p class="success-description">Check your email for password reset instructions.</p>

                        <button type="button" class="primary-button" onclick={showLogin}>
                            <lightning-icon icon-name="utility:back" size="x-small"
                                class="button-icon"></lightning-icon>
                            <span>Return to Login</span>
                        </button>
                    </div>
                </template>
            </template>

            <!-- Loading Spinner Overlay -->
            <template if:true={isLoading}>
                <div class="loading-overlay">
                    <lightning-spinner alternative-text="Loading" size="medium" variant="brand">
                    </lightning-spinner>
                </div>
            </template>
            <!-- Filter Info -->
            <div class="footer-info">
                <p>Student Intern Portal • Your Journey Starts Here</p>
                <p class="version">v2.0 • Built with Salesforce</p>
            </div>
        </div>
    </div>
</template>