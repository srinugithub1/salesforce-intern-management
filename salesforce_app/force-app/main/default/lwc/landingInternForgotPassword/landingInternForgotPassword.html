<template>
    <div class="forgot-password-container">
        <!-- Animated Background -->
        <div class="background-animation">
            <div class="floating-shape shape-1"></div>
            <div class="floating-shape shape-2"></div>
            <div class="floating-shape shape-3"></div>
            <div class="floating-shape shape-4"></div>
            <div class="gradient-overlay"></div>
        </div>

        <!-- Main Glass Card -->
        <div class="glass-card fade-in">
            <!-- Success View -->
            <template if:true={isSuccess}>
                <div class="success-view">
                    <div class="success-icon-wrapper">
                        <lightning-icon
                            icon-name="utility:success"
                            size="large"
                            class="success-icon">
                        </lightning-icon>
                    </div>
                    <h1 class="success-title">Request Sent!</h1>
                    <p class="success-message">
                        If your details match our records, you will receive a password reset email shortly.
                        Please check your inbox and spam folder.
                    </p>
                    <button class="primary-button" onclick={handleBackToLogin}>
                        <lightning-icon icon-name="utility:back" size="x-small" class="button-icon"></lightning-icon>
                        <span>Back to Login</span>
                    </button>
                </div>
            </template>

            <!-- Form View -->
            <template if:false={isSuccess}>
                <!-- Header -->
                <div class="forgot-password-header">
                    <div class="logo-wrapper">
                        <lightning-icon
                            icon-name="utility:lock"
                            size="large"
                            class="logo-icon">
                        </lightning-icon>
                    </div>
                    <h1 class="main-title">Reset Password</h1>
                    <p class="subtitle">Enter your details to receive a password reset link</p>
                    <div class="divider"></div>
                </div>

                <!-- Error Message -->
                <template if:true={errorMsg}>
                    <div class="error-alert">
                        <lightning-icon
                            icon-name="utility:warning"
                            size="x-small"
                            class="error-icon">
                        </lightning-icon>
                        <span class="error-text">{errorMsg}</span>
                    </div>
                </template>

                <!-- Form -->
                <form class="forgot-password-form" onsubmit={handleFormSubmit}>
                    <!-- Email Input -->
                    <div class="input-wrapper">
                        <div class="input-icon">
                            <lightning-icon icon-name="utility:email" size="x-small"></lightning-icon>
                        </div>
                        <input
                            type="email"
                            placeholder="Enter Your Email Address"
                            data-id="email"
                            oninput={handleInput}
                            required
                            class="modern-input">
                    </div>

                    <!-- College Input -->
                    <div class="input-wrapper">
                        <div class="input-icon">
                            <lightning-icon icon-name="utility:education" size="x-small"></lightning-icon>
                        </div>
                        <input
                            type="text"
                            placeholder="College/University Name"
                            data-id="college"
                            oninput={handleInput}
                            required
                            class="modern-input">
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" class="primary-button" disabled={isLoading}>
                        <template if:false={isLoading}>
                            <lightning-icon icon-name="utility:email" size="x-small" class="button-icon"></lightning-icon>
                            <span>Send Reset Link</span>
                        </template>
                        <template if:true={isLoading}>
                            <span>Sending Request...</span>
                        </template>
                    </button>

                    <!-- Back to Login Link -->
                    <div class="separator">
                        <span>Remember your password?</span>
                    </div>

                    <button type="button" class="secondary-button" onclick={handleBackToLogin}>
                        <lightning-icon icon-name="utility:back" size="x-small" class="button-icon"></lightning-icon>
                        <span>Back to Login</span>
                    </button>
                </form>

                <!-- Loading Spinner Overlay -->
                <template if:true={isLoading}>
                    <div class="loading-overlay">
                        <lightning-spinner
                            alternative-text="Loading"
                            size="medium"
                            variant="brand">
                        </lightning-spinner>
                    </div>
                </template>
            </template>
        </div>

        <!-- Footer Info -->
        <div class="footer-info">
            <p>Secure Password Reset • Student Intern Portal</p>
            <p class="version">v2.0 • Protected Access</p>
        </div>
    </div>
</template>
