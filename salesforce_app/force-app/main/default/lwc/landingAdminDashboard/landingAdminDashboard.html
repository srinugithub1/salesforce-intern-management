<template>
    <div class="dashboard-wrapper">
        <!-- TOP HEADER -->
        <header class="app-header">
            <div class="header-left">
                <div class="brand-logo">
                    <img src={logoUrl} alt="LearnersByte Expertpedia" class="logo-image" />
                </div>
            </div>
            <div class="header-center">
                <div class="datetime-display">
                    <div class="time-display">{currentTime}</div>
                    <div class="date-display">{currentDate}</div>
                </div>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span class="user-role">{formattedRole}</span>
                    <button class="logout-btn" onclick={handleLogout}>
                        <lightning-icon icon-name="utility:logout" size="x-small"></lightning-icon>
                        Logout
                    </button>
                </div>
            </div>
        </header>

        <!-- TAB NAVIGATION -->
        <nav class="tab-navigation">
            <button class={navClassDashboard} onclick={handleTabSwitch} data-tab="dashboard">
                <lightning-icon icon-name="utility:graph" size="x-small"></lightning-icon>
                Dashboard
            </button>
            <button class={navClassInterns} onclick={handleTabSwitch} data-tab="interns">
                <lightning-icon icon-name="utility:education" size="x-small"></lightning-icon>
                Interns
            </button>
            <button class={navClassMentorship} onclick={handleTabSwitch} data-tab="mentorship">
                <lightning-icon icon-name="utility:messages" size="x-small"></lightning-icon>
                Mentorship
            </button>
            <button class={navClassLogs} onclick={handleTabSwitch} data-tab="logs">
                <lightning-icon icon-name="utility:record" size="x-small"></lightning-icon>
                Intern Diary
            </button>
            <button class={navClassSyllabus} onclick={handleTabSwitch} data-tab="syllabus">
                <lightning-icon icon-name="utility:knowledge_base" size="x-small"></lightning-icon>
                Course Syllabus
            </button>
            <button class={navClassSessionLinks} onclick={handleTabSwitch} data-tab="sessionlinks">
                <lightning-icon icon-name="utility:link" size="x-small"></lightning-icon>
                <span>Session Links</span>
            </button>
            <button class={navClassAnnouncements} onclick={handleTabSwitch} data-tab="announcements">
                <lightning-icon icon-name="utility:announcement" size="x-small"></lightning-icon>
                Announcements
            </button>
            <button class={navClassResources} onclick={handleTabSwitch} data-tab="resources">
                <lightning-icon icon-name="utility:resource_skill" size="x-small"></lightning-icon>
                Resources
            </button>
            <button class={navClassTasks} onclick={handleTabSwitch} data-tab="tasks">
                <lightning-icon icon-name="utility:task" size="x-small"></lightning-icon>
                Tasks
            </button>
        </nav>

        <!-- MAIN CONTENT -->
        <main class="content-area">

            <!-- DASHBOARD VIEW -->
            <template if:true={isDashboardTab}>
                <div class="dashboard-content">
                    <div class="welcome-section">
                        <h2>Welcome Back, <span>{formattedRole}</span></h2>
                        <p>Here's what's happening with your interns today.</p>
                    </div>

                    <!-- Metrics Cards -->
                    <div class="metrics-row">
                        <div class="metric-card" onclick={handleTabSwitch} data-tab="interns">
                            <div class="metric-icon">
                                <lightning-icon icon-name="utility:education" size="large"></lightning-icon>
                            </div>
                            <div class="metric-data">
                                <h3>{metrics.totalInterns}</h3>
                                <p>Total Interns</p>
                            </div>
                        </div>
                        <div class="metric-card" onclick={handleTabSwitch} data-tab="syllabus">
                            <div class="metric-icon">
                                <lightning-icon icon-name="utility:knowledge_base" size="large"></lightning-icon>
                            </div>
                            <div class="metric-data">
                                <h3>{metrics.syllabusCount}</h3>
                                <p>Course Topics</p>
                            </div>
                        </div>
                        <div class="metric-card" onclick={handleNavigateToTasks}>
                            <div class="metric-icon">
                                <lightning-icon icon-name="utility:task" size="large"></lightning-icon>
                            </div>
                            <div class="metric-data">
                                <h3>{metrics.totalTasks}</h3>
                                <p>Manage Tasks</p>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Grid -->
                    <div class="charts-row">
                        <div class="chart-card">
                            <h3>Task Status</h3>
                            <div class="chart-content">
                                <svg viewBox="0 0 36 36" class="circular-chart">
                                    <path class="circle-bg"
                                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                    <path class="circle" stroke-dasharray={taskChartData}
                                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                    <text x="18" y="20.35" class="percentage">{taskCompletionRate}%</text>
                                </svg>
                                <div class="chart-legend">
                                    <div class="legend-item">
                                        <span class="dot completed"></span> Completed:
                                        {taskStats.Completed}/{metrics.totalTasks}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="chart-card">
                            <h3>Deadlines Status</h3>
                            <div class="chart-content">
                                <svg viewBox="0 0 36 36" class="circular-chart">
                                    <path class="circle-bg"
                                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                    <path class="circle" stroke-dasharray={deadlineUrgentStroke} stroke="#ef4444"
                                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                    <path class="circle" stroke-dasharray={deadlineUpcomingStroke}
                                        stroke-dashoffset={deadlineUpcomingOffset} stroke="#f59e0b"
                                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                </svg>
                                <div class="chart-legend">
                                    <div class="legend-item"><span class="dot urgent"></span> Urgent:
                                        {deadlineStats.Urgent}</div>
                                    <div class="legend-item"><span class="dot upcoming"></span> Upcoming:
                                        {deadlineStats.Upcoming}</div>
                                </div>
                            </div>
                        </div>

                        <div class="chart-card">
                            <h3>Task Priority</h3>
                            <div class="priority-bars">
                                <div class="stacked-bar">
                                    <div class="stack-segment high" style={priorityHighStyle}></div>
                                    <div class="stack-segment medium" style={priorityMedStyle}></div>
                                    <div class="stack-segment low" style={priorityLowStyle}></div>
                                </div>
                                <div class="chart-legend">
                                    <div class="legend-item"><span class="dot high"></span> High: {priorityStats.High}
                                    </div>
                                    <div class="legend-item"><span class="dot medium"></span> Med:
                                        {priorityStats.Medium}</div>
                                    <div class="legend-item"><span class="dot low"></span> Low: {priorityStats.Low}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Activity & Top Performers -->
                    <div class="info-row">
                        <div class="activity-card">
                            <h3>Recent Updates</h3>
                            <div class="activity-list">
                                <template for:each={activities} for:item="act">
                                    <div key={act.id} class="activity-item">
                                        <p>{act.message}</p>
                                        <span>{act.activityDate}</span>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="performers-card">
                            <h3>Top Performers</h3>
                            <div class="performers-list">
                                <template for:each={topInterns} for:item="intern">
                                    <div key={intern.id} class="performer-item">
                                        <span class="rank">#{intern.rank}</span>
                                        <div class="performer-info">
                                            <p class="name">{intern.name}</p>
                                            <p class="score">{intern.completedTasks} Tasks</p>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- INTERNS VIEW -->
            <template if:true={isInternsTab}>
                <div class="content-card">
                    <div class="card-header">
                        <div class="header-info">
                            <h2>Intern Management</h2>
                            <p>View and manage registered interns</p>
                        </div>
                        <span class="record-badge">Total: {totalInternsCount}</span>
                    </div>

                    <div class="filter-bar">
                        <input type="text" placeholder="Filter by Name" value={filterInternName} data-field="internName"
                            oninput={handleInternFilterChange} class="filter-input" />
                        <input type="text" placeholder="Filter by Email" value={filterInternEmail}
                            data-field="internEmail" oninput={handleInternFilterChange} class="filter-input" />
                        <input type="text" placeholder="Roll Number" value={filterInternRoll} data-field="internRoll"
                            oninput={handleInternFilterChange} class="filter-input" />
                        <input type="text" placeholder="College Name" value={filterInternCollege}
                            data-field="internCollege" oninput={handleInternFilterChange} class="filter-input" />
                    </div>

                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Roll Number</th>
                                    <th>College Name</th>
                                    <th>Address</th>
                                    <template if:true={isSuperAdmin}>
                                        <th>Team Lead</th>
                                    </template>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={visibleInterns} for:item="row">
                                    <tr key={row.Id}>
                                        <td>{row.Name}</td>
                                        <td><a href={row.mailtoEmail}>{row.Email__c}</a></td>
                                        <td>{row.Phone__c}</td>
                                        <td>{row.Roll_Number__c}</td>
                                        <td>{row.College_Name__c}</td>
                                        <td>{row.Address__c}</td>
                                        <template if:true={isSuperAdmin}>
                                            <td>{row.TeamLeadName}</td>
                                        </template>
                                        <td>
                                            <button class="action-btn delete" onclick={handleInternAction}
                                                data-id={row.Id} data-action="delete">
                                                <lightning-icon icon-name="utility:delete"
                                                    size="x-small"></lightning-icon>
                                            </button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination">
                        <span>Total Records: {totalInternsCount}</span>
                        <div class="pagination-controls">
                            <lightning-button label="Previous" onclick={handlePrev} data-tab="interns"
                                disabled={isInternsFirstPage} variant="neutral"></lightning-button>
                            <span>Page {currentPageInterns} of {totalInternsPages}</span>
                            <lightning-button label="Next" onclick={handleNext} data-tab="interns"
                                disabled={isInternsLastPage} variant="neutral"></lightning-button>
                        </div>
                    </div>
                </div>
            </template>

            <!-- MENTORSHIP VIEW -->
            <template if:true={isMentorshipTab}>
                <div class="content-card">
                    <div class="card-header">
                        <div class="header-info">
                            <h2>Mentorship Requests</h2>
                            <p>Provide guidance and reply to intern queries</p>
                        </div>
                        <span class="record-badge">Total: {totalMentorshipCount}</span>
                    </div>

                    <div class="filter-bar">
                        <input type="text" placeholder="Filter by Intern Name" value={filterMentorshipInternName}
                            data-field="mentorshipInternName" oninput={handleMentorshipFilterChange}
                            class="filter-input" />
                        <select class="filter-input" data-field="mentorshipType"
                            onchange={handleMentorshipFilterChange}>
                            <option value="">All Types</option>
                            <option value="General">General</option>
                            <option value="Technical">Technical</option>
                            <option value="HR">HR</option>
                            <option value="Project">Project</option>
                        </select>
                        <select class="filter-input" data-field="mentorshipStatus"
                            onchange={handleMentorshipFilterChange}>
                            <option value="">All Status</option>
                            <option value="Pending">Pending</option>
                            <option value="Replied">Replied</option>
                        </select>
                    </div>

                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Intern</th>
                                    <th>Type</th>
                                    <th>Status</th>
                                    <th>Description</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={visibleMentorships} for:item="row">
                                    <tr key={row.Id}>
                                        <td>{row.InternName}</td>
                                        <td>{row.Request_Type__c}</td>
                                        <td><span class={row.statusClass}>{row.Status__c}</span></td>
                                        <td>{row.Description__c}</td>
                                        <td>
                                            <button class="action-btn" onclick={handleMentorshipAction} data-id={row.Id}
                                                data-action="reply">
                                                <lightning-icon icon-name="utility:reply"
                                                    size="x-small"></lightning-icon>
                                            </button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination">
                        <span>Total Records: {totalMentorshipCount}</span>
                        <div class="pagination-controls">
                            <lightning-button label="Previous" onclick={handlePrev} data-tab="mentorship"
                                disabled={isMentorshipFirstPage} variant="neutral"></lightning-button>
                            <span>Page {currentPageMentorship} of {totalMentorshipPages}</span>
                            <lightning-button label="Next" onclick={handleNext} data-tab="mentorship"
                                disabled={isMentorshipLastPage} variant="neutral"></lightning-button>
                        </div>
                    </div>
                </div>
            </template>

            <!-- LOGS VIEW -->
            <template if:true={isLogsTab}>
                <div class="content-card">
                    <div class="card-header">
                        <div class="header-info">
                            <h2>Intern Diary</h2>
                            <p>Track daily work logs and learning progress</p>
                        </div>
                        <span class="record-badge">Total: {totalLogsCount}</span>
                    </div>

                    <div class="filter-bar">
                        <input type="text" placeholder="Search Intern Name..." value={logFilterInternName}
                            data-field="internName" oninput={handleLogFilterChange} class="filter-input" />
                        <select class="filter-input" data-field="course" onchange={handleLogFilterChange}>
                            <template for:each={courseOptions} for:item="opt">
                                <option key={opt.value} value={opt.value}>{opt.label}</option>
                            </template>
                        </select>
                        <select class="filter-input" data-field="module" onchange={handleLogFilterChange}>
                            <template for:each={moduleOptions} for:item="opt">
                                <option key={opt.value} value={opt.value}>{opt.label}</option>
                            </template>
                        </select>

                    </div>

                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Intern</th>
                                    <th>Date</th>
                                    <th>Course</th>
                                    <th>Module</th>

                                    <th>Hours</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={visibleLogs} for:item="row">
                                    <tr key={row.Id}>
                                        <td>{row.InternName}</td>
                                        <td>{row.formattedDate}</td>
                                        <td>{row.Course__c}</td>
                                        <td>{row.Module__c}</td>

                                        <td>{row.Hours_Spent__c}</td>
                                        <td>{row.Work_Description__c}</td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination">
                        <span>Total Records: {totalLogsCount}</span>
                        <div class="pagination-controls">
                            <lightning-button label="Previous" onclick={handlePrev} data-tab="logs"
                                disabled={isLogsFirstPage} variant="neutral"></lightning-button>
                            <span>Page {currentPageLogs} of {totalLogsPages}</span>
                            <lightning-button label="Next" onclick={handleNext} data-tab="logs"
                                disabled={isLogsLastPage} variant="neutral"></lightning-button>
                        </div>
                    </div>
                </div>
            </template>

            <!-- SYLLABUS VIEW -->
            <template if:true={isSyllabusTab}>
                <div class="content-card">
                    <div class="card-header">
                        <div class="header-info">
                            <h2>Course Syllabus</h2>
                            <p>Structure the learning curriculum</p>
                        </div>
                        <div class="header-actions">
                            <span class="record-badge">Total: {totalSyllabusCount}</span>
                            <lightning-button label="Add Topic" onclick={openSyllabusModal} variant="brand"
                                icon-name="utility:add" class="add-btn"></lightning-button>
                        </div>
                    </div>

                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Course</th>
                                    <th>Module</th>

                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={visibleSyllabus} for:item="row">
                                    <tr key={row.Id}>
                                        <td>{row.Course_Name__c}</td>
                                        <td>{row.Module_Name__c}</td>

                                        <td>
                                            <div class="action-group">
                                                <button class="action-btn" onclick={handleSyllabusAction}
                                                    data-id={row.Id} data-action="edit">
                                                    <lightning-icon icon-name="utility:edit"
                                                        size="x-small"></lightning-icon>
                                                </button>
                                                <button class="action-btn delete" onclick={handleSyllabusAction}
                                                    data-id={row.Id} data-action="delete">
                                                    <lightning-icon icon-name="utility:delete"
                                                        size="x-small"></lightning-icon>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination">
                        <span>Total Records: {totalSyllabusCount}</span>
                        <div class="pagination-controls">
                            <lightning-button label="Previous" onclick={handlePrev} data-tab="syllabus"
                                disabled={isSyllabusFirstPage} variant="neutral"></lightning-button>
                            <span>Page {currentPageSyllabus} of {totalSyllabusPages}</span>
                            <lightning-button label="Next" onclick={handleNext} data-tab="syllabus"
                                disabled={isSyllabusLastPage} variant="neutral"></lightning-button>
                        </div>
                    </div>
                </div>
            </template>

            <!-- SESSION LINKS TAB -->
            <template if:true={isSessionLinksTab}>
                <div class="content-card animate-fade-in">
                    <!-- Header -->
                    <div class="card-header">
                        <div class="header-info">
                            <h2>Class Session Links</h2>
                            <p>Manage online class session links and schedules</p>
                        </div>
                        <div class="header-actions">
                            <span class="record-badge">
                                <lightning-icon icon-name="utility:database" size="xx-small"></lightning-icon>
                                Total: {totalSessionLinksCount}
                            </span>
                            <lightning-button
                                label="New Session Link"
                                onclick={openSessionLinksModal}
                                variant="brand"
                                icon-name="utility:add"
                                class="add-btn">
                            </lightning-button>
                        </div>
                    </div>

                    <!-- Table -->
                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Agenda</th>
                                    <th>Date</th>
                                    <th>Start Time</th>
                                    <th>End Time</th>
                                    <th>Speaker</th>
                                    <th>Session URL</th>
                                    <th class="action-col">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={visibleSessionLinks} for:item="row">
                                    <tr key={row.Id}>
                                        <td>{row.Agenda__c}</td>
                                        <td>{row.formattedDate}</td>
                                        <td>{row.formattedStartTime}</td>
                                        <td>{row.formattedEndTime}</td>
                                        <td>{row.Speaker__c}</td>
                                        <td>
                                            <a href={row.Session_URL__c}
                                               target="_blank"
                                               class="url-link">
                                                <lightning-icon icon-name="utility:new_window" size="xx-small"></lightning-icon>
                                                Open Link
                                            </a>
                                        </td>
                                        <td>
                                            <div class="action-group">
                                                <button class="action-btn edit"
                                                        title="Edit"
                                                        onclick={handleSessionLinksAction}
                                                        data-id={row.Id}
                                                        data-action="edit">
                                                    <lightning-icon icon-name="utility:edit" size="x-small"></lightning-icon>
                                                </button>
                                                <button class="action-btn delete"
                                                        title="Delete"
                                                        onclick={handleSessionLinksAction}
                                                        data-id={row.Id}
                                                        data-action="delete">
                                                    <lightning-icon icon-name="utility:delete" size="x-small"></lightning-icon>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>

                        <!-- Empty State -->
                        <template if:false={sessionLinks.length}>
                            <div class="empty-state">
                                <lightning-icon icon-name="utility:link" size="large"></lightning-icon>
                                <h3>No Session Links Found</h3>
                                <p>Get started by creating your first class session link</p>
                            </div>
                        </template>
                    </div>

                    <!-- Pagination -->
                    <template if:true={sessionLinks.length}>
                        <div class="pagination">
                            <span class="pagination-info">
                                Showing {visibleSessionLinks.length} of {totalSessionLinksCount} session links
                            </span>
                            <div class="pagination-controls">
                                <lightning-button
                                    label="Previous"
                                    onclick={handlePrev}
                                    data-tab="sessionlinks"
                                    disabled={isSessionLinksFirstPage}
                                    variant="neutral"
                                    icon-name="utility:chevronleft">
                                </lightning-button>
                                <span class="page-indicator">
                                    Page {currentPageSessionLinks} of {totalSessionLinksPages}
                                </span>
                                <lightning-button
                                    label="Next"
                                    onclick={handleNext}
                                    data-tab="sessionlinks"
                                    disabled={isSessionLinksLastPage}
                                    variant="neutral"
                                    icon-name="utility:chevronright"
                                    icon-position="right">
                                </lightning-button>
                            </div>
                        </div>
                    </template>
                </div>
            </template>

            <!-- ANNOUNCEMENTS VIEW -->
            <template if:true={isAnnouncementsTab}>
                <div class="content-card">
                    <div class="card-header">
                        <div class="header-info">
                            <h2>Announcements</h2>
                            <p>Broadcast updates and news to interns</p>
                        </div>
                        <div class="header-actions">
                            <span class="record-badge">Total: {totalAnnouncementsCount}</span>
                            <lightning-button label="New Announcement" onclick={openAnnouncementModal} variant="brand"
                                icon-name="utility:add" class="add-btn"></lightning-button>
                        </div>
                    </div>

                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Message</th>
                                    <th>Type</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={visibleAnnouncements} for:item="row">
                                    <tr key={row.Id}>
                                        <td>{row.Message__c}</td>
                                        <td><span class={row.typeClass}>{row.Type__c}</span></td>
                                        <td>
                                            <button class="action-btn delete" onclick={handleAnnouncementAction}
                                                data-id={row.Id} data-action="delete">
                                                <lightning-icon icon-name="utility:delete"
                                                    size="x-small"></lightning-icon>
                                            </button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination">
                        <span>Total Records: {totalAnnouncementsCount}</span>
                        <div class="pagination-controls">
                            <lightning-button label="Previous" onclick={handlePrev} data-tab="announcements"
                                disabled={isAnnouncementsFirstPage} variant="neutral"></lightning-button>
                            <span>Page {currentPageAnnouncements} of {totalAnnouncementsPages}</span>
                            <lightning-button label="Next" onclick={handleNext} data-tab="announcements"
                                disabled={isAnnouncementsLastPage} variant="neutral"></lightning-button>
                        </div>
                    </div>
                </div>
            </template>

            <!-- RESOURCES VIEW -->
            <template if:true={isResourcesTab}>
                <div class="content-card">
                    <div class="card-header">
                        <div class="header-info">
                            <h2>Learning Resources</h2>
                            <p>Manage educational materials and links</p>
                        </div>
                        <div class="header-actions">
                            <span class="record-badge">Total: {totalResourcesCount}</span>
                            <lightning-button label="New Resource" onclick={openResourceModal} variant="brand"
                                icon-name="utility:add" class="add-btn"></lightning-button>
                        </div>
                    </div>

                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Link</th>
                                    <th>Type</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={visibleResources} for:item="row">
                                    <tr key={row.Id}>
                                        <td>{row.Title__c}</td>
                                        <td><a href={row.Link__c} target="_blank">Open Link</a></td>
                                        <td><span class={row.typeClass}>{row.Type__c}</span></td>
                                        <td>
                                            <button class="action-btn delete" onclick={handleResourceAction}
                                                data-id={row.Id} data-action="delete">
                                                <lightning-icon icon-name="utility:delete"
                                                    size="x-small"></lightning-icon>
                                            </button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination">
                        <span>Total Records: {totalResourcesCount}</span>
                        <div class="pagination-controls">
                            <lightning-button label="Previous" onclick={handlePrev} data-tab="resources"
                                disabled={isResourcesFirstPage} variant="neutral"></lightning-button>
                            <span>Page {currentPageResources} of {totalResourcesPages}</span>
                            <lightning-button label="Next" onclick={handleNext} data-tab="resources"
                                disabled={isResourcesLastPage} variant="neutral"></lightning-button>
                        </div>
                    </div>
                </div>
            </template>

            <!-- TASKS VIEW -->
            <template if:true={isTasksTab}>
                <div class="content-card">
                    <div class="card-header">
                        <div class="header-info">
                            <h2>Task Management</h2>
                            <p>Manage and track intern assignments</p>
                        </div>
                        <div class="header-actions">
                            <span class="record-badge">Total: {totalRecords}</span>
                            <lightning-button label="Assign New Task" onclick={openTaskModal} variant="brand"
                                icon-name="utility:add" class="add-btn"></lightning-button>
                        </div>
                    </div>

                    <div class="filter-bar">
                        <input type="text" placeholder="Filter by Task Name" value={filterTaskName}
                            data-field="taskName" oninput={handleFilterChange} class="filter-input" />
                        <input type="text" placeholder="Filter by Intern Name" value={filterInternName}
                            data-field="internName" oninput={handleFilterChange} class="filter-input" />
                        <select class="filter-input" data-field="status" onchange={handleFilterChange}>
                            <template for:each={statusOptions} for:item="opt">
                                <option key={opt.value} value={opt.value} selected={opt.selected}>{opt.label}</option>
                            </template>
                        </select>
                        <input type="date" class="filter-input" data-field="dueDate" onchange={handleFilterChange}
                            value={filterDate} />
                        <button class="action-btn" onclick={resetFilters} title="Reset">
                            <lightning-icon icon-name="utility:refresh" size="x-small"></lightning-icon>
                        </button>
                    </div>

                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Task Name</th>
                                    <th>Assigned To</th>
                                    <th>Priority</th>
                                    <th>Due Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={tasks} for:item="row">
                                    <tr key={row.Id}>
                                        <td>{row.Name}</td>
                                        <td>{row.InternName}</td>
                                        <td>{row.Priority__c}</td>
                                        <td>{row.formattedDate}</td>
                                        <td><span class={row.statusClass}>{row.Status__c}</span></td>
                                        <td>
                                            <div class="action-group">
                                                <button class="action-btn" onclick={handleTaskAction} data-id={row.Id}
                                                    data-action="edit">
                                                    <lightning-icon icon-name="utility:edit"
                                                        size="x-small"></lightning-icon>
                                                </button>
                                                <button class="action-btn delete" onclick={handleTaskAction}
                                                    data-id={row.Id} data-action="delete">
                                                    <lightning-icon icon-name="utility:delete"
                                                        size="x-small"></lightning-icon>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination">
                        <span>Total Records: {totalRecords}</span>
                        <div class="pagination-controls">
                            <lightning-button label="Previous" onclick={handlePreviousPage} disabled={isFirstPage}
                                variant="neutral"></lightning-button>
                            <span>Page {currentPage} of {totalPages}</span>
                            <lightning-button label="Next" onclick={handleNextPage} disabled={isLastPage}
                                variant="neutral"></lightning-button>
                        </div>
                    </div>
                </div>
            </template>

        </main>

        <!-- MODALS (unchanged) -->
        <template if:true={isMentorshipModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                            title="Close" onclick={closeMentorshipModal}>
                            <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse"
                                size="small"></lightning-icon>
                        </button>
                        <h2 class="slds-text-heading_medium">Reply to Request</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-form">
                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">* Mentor Response</label>
                                <textarea class={mentorResponseClass} rows="4" oninput={handleResponseChangeCustom}
                                    placeholder="Enter your feedback or reply...">{mentorResponse}</textarea>
                                <template if:true={mentorErrors.response}>
                                    <div class="input-error-msg">Response is required</div>
                                </template>
                            </div>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="btn-secondary" onclick={closeMentorshipModal}>Cancel</button>
                        <button class="btn-primary" onclick={saveMentorshipReply}>Send Reply</button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

        <template if:true={isAnnouncementModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <h2 class="slds-text-heading_medium">New Announcement</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-form">
                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">* Announcement Message</label>
                                <textarea class={announcementMessageClass} rows="4" data-field="Message__c"
                                    oninput={handleAnnouncementInputChangeCustom}
                                    placeholder="Enter message...">{announcementForm.Message__c}</textarea>
                                <template if:true={announcementErrors.message}>
                                    <div class="input-error-msg">Message is required</div>
                                </template>
                            </div>
                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">Type</label>
                                <select class="premium-input" data-field="Type__c"
                                    onchange={handleAnnouncementInputChangeCustom}>
                                    <template for:each={announcementTypeOptionsComputed} for:item="option">
                                        <option key={option.value} value={option.value} selected={option.selected}>
                                            {option.label}</option>
                                    </template>
                                </select>
                            </div>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="btn-secondary" onclick={closeAnnouncementModal}>Cancel</button>
                        <button class="btn-primary" onclick={saveAnnouncementRecord}>Save Announcement</button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

        <template if:true={isResourceModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <h2 class="slds-text-heading_medium">New Resource</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-form">
                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">* Title</label>
                                <input type="text" class={resourceTitleClass} value={resourceForm.Title__c}
                                    data-field="Title__c" oninput={handleResourceInputChangeCustom}
                                    placeholder="Resource Title..." />
                                <template if:true={resourceErrors.title}>
                                    <div class="input-error-msg">Title is required</div>
                                </template>
                            </div>
                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">* Link URL</label>
                                <input type="url" class={resourceLinkClass} value={resourceForm.Link__c}
                                    data-field="Link__c" oninput={handleResourceInputChangeCustom}
                                    placeholder="https://..." />
                                <template if:true={resourceErrors.link}>
                                    <div class="input-error-msg">Link is required</div>
                                </template>
                            </div>
                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">Type</label>
                                <select class="premium-input" data-field="Type__c"
                                    onchange={handleResourceInputChangeCustom}>
                                    <template for:each={resourceTypeOptionsComputed} for:item="option">
                                        <option key={option.value} value={option.value} selected={option.selected}>
                                            {option.label}</option>
                                    </template>
                                </select>
                            </div>
                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">Description</label>
                                <textarea class="premium-input" rows="3" data-field="Description__c"
                                    oninput={handleResourceInputChangeCustom}
                                    placeholder="Optional details...">{resourceForm.Description__c}</textarea>
                            </div>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="btn-secondary" onclick={closeResourceModal}>Cancel</button>
                        <button class="btn-primary" onclick={saveResourceRecord}>Save Resource</button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

        <template if:true={isSyllabusModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                            title="Close" onclick={closeSyllabusModal}>
                            <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse"
                                size="small"></lightning-icon>
                        </button>
                        <h2 class="slds-text-heading_medium">{syllabusModalTitle}</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-form">
                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">* Course Name</label>
                                <input type="text" class="premium-input" data-field="Course_Name__c"
                                    value={syllabusForm.Course_Name__c} oninput={handleSyllabusInputChange} />
                            </div>
                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">* Module Name</label>
                                <input type="text" class="premium-input" data-field="Module_Name__c"
                                    value={syllabusForm.Module_Name__c} oninput={handleSyllabusInputChange} />
                            </div>

                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="btn-secondary" onclick={closeSyllabusModal}>Cancel</button>
                        <button class="btn-primary" onclick={saveSyllabusRecord}>Save</button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

        <!-- SESSION LINKS MODAL -->
        <template if:true={isSessionLinksModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open slds-modal_large">
                <div class="slds-modal__container">
                    <!-- Modal Header -->
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                                title="Close"
                                onclick={closeSessionLinksModal}>
                            <lightning-icon icon-name="utility:close" size="small"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 class="slds-text-heading_medium slds-hyphenate">
                            <lightning-icon icon-name="utility:link" size="small" class="modal-icon"></lightning-icon>
                            {sessionLinksModalTitle}
                        </h2>
                    </header>

                    <!-- Modal Body -->
                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-form">
                            <div class="form-row">
                                <!-- Agenda Field (Required) -->
                                <div class="premium-input-wrapper">
                                    <label class="premium-input-label">
                                        <span class="required-asterisk">*</span> Agenda
                                    </label>
                                    <input type="text"
                                           class={agendaInputClass}
                                           value={sessionLinksForm.Agenda__c}
                                           data-field="Agenda__c"
                                           oninput={handleSessionLinksInputChange}
                                           placeholder="Enter session agenda or topic"
                                           maxlength="255" />
                                    <template if:true={sessionLinksErrors.agenda}>
                                        <div class="input-error-msg">
                                            <lightning-icon icon-name="utility:error" size="xx-small"></lightning-icon>
                                            Agenda is required
                                        </div>
                                    </template>
                                </div>

                                <!-- Date Field (Required) -->
                                <div class="premium-input-wrapper">
                                    <label class="premium-input-label">
                                        <span class="required-asterisk">*</span> Date
                                    </label>
                                    <input type="date"
                                           class={dateInputClass}
                                           value={sessionLinksForm.Date__c}
                                           data-field="Date__c"
                                           oninput={handleSessionLinksInputChange} />
                                    <template if:true={sessionLinksErrors.date}>
                                        <div class="input-error-msg">
                                            <lightning-icon icon-name="utility:error" size="xx-small"></lightning-icon>
                                            Date is required
                                        </div>
                                    </template>
                                </div>
                            </div>

                            <div class="form-row">
                                <!-- Start Time Field (Required) -->
                                <div class="premium-input-wrapper">
                                    <label class="premium-input-label">
                                        <span class="required-asterisk">*</span> Start Time
                                    </label>
                                    <input type="time"
                                           class={startTimeInputClass}
                                           value={sessionLinksForm.Session_Start__c}
                                           data-field="Session_Start__c"
                                           oninput={handleSessionLinksInputChange} />
                                    <template if:true={sessionLinksErrors.startTime}>
                                        <div class="input-error-msg">
                                            <lightning-icon icon-name="utility:error" size="xx-small"></lightning-icon>
                                            Start time is required
                                        </div>
                                    </template>
                                </div>

                                <!-- End Time Field (Required) -->
                                <div class="premium-input-wrapper">
                                    <label class="premium-input-label">
                                        <span class="required-asterisk">*</span> End Time
                                    </label>
                                    <input type="time"
                                           class={endTimeInputClass}
                                           value={sessionLinksForm.Session_End__c}
                                           data-field="Session_End__c"
                                           oninput={handleSessionLinksInputChange} />
                                    <template if:true={sessionLinksErrors.endTime}>
                                        <div class="input-error-msg">
                                            <lightning-icon icon-name="utility:error" size="xx-small"></lightning-icon>
                                            End time is required and must be after start time
                                        </div>
                                    </template>
                                </div>
                            </div>

                            <div class="form-row">
                                <!-- Session URL Field (Required) -->
                                <div class="premium-input-wrapper full-width">
                                    <label class="premium-input-label">
                                        <span class="required-asterisk">*</span> Session URL
                                    </label>
                                    <input type="url"
                                           class={urlInputClass}
                                           value={sessionLinksForm.Session_URL__c}
                                           data-field="Session_URL__c"
                                           oninput={handleSessionLinksInputChange}
                                           placeholder="https://teams.microsoft.com/..."
                                           maxlength="255" />
                                    <template if:true={sessionLinksErrors.url}>
                                        <div class="input-error-msg">
                                            <lightning-icon icon-name="utility:error" size="xx-small"></lightning-icon>
                                            Session URL is required
                                        </div>
                                    </template>
                                </div>
                            </div>

                            <div class="form-row">
                                <!-- Speaker Field (Optional) -->
                                <div class="premium-input-wrapper full-width">
                                    <label class="premium-input-label">Speaker</label>
                                    <input type="text"
                                           class="premium-input"
                                           value={sessionLinksForm.Speaker__c}
                                           data-field="Speaker__c"
                                           oninput={handleSessionLinksInputChange}
                                           placeholder="Enter speaker name (optional)"
                                           maxlength="50" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Footer -->
                    <footer class="slds-modal__footer">
                        <button class="btn-secondary" onclick={closeSessionLinksModal}>
                            <lightning-icon icon-name="utility:close" size="x-small"></lightning-icon>
                            Cancel
                        </button>
                        <button class="btn-primary" onclick={saveSessionLinksRecord}>
                            <lightning-icon icon-name="utility:check" size="x-small"></lightning-icon>
                            Save Session Link
                        </button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

        <template if:true={isTaskModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <h2 class="slds-text-heading_medium">{taskModalTitle}</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-form">
                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">* Task Name</label>
                                <input type="text" class={nameInputClass} value={taskForm.Name} data-field="Name"
                                    oninput={handleTaskInputChangeCustom} placeholder="Enter task name..." />
                                <template if:true={errors.name}>
                                    <div class="input-error-msg">Task Name is required</div>
                                </template>
                            </div>

                            <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                    <div class="premium-input-wrapper">
                                        <label class="premium-input-label">* Due Date</label>
                                        <input type="date" class={dateInputClass} value={taskForm.Due_Date__c}
                                            data-field="Due_Date__c" onchange={handleTaskInputChangeCustom} />
                                        <template if:true={errors.date}>
                                            <div class="input-error-msg">Due Date is required</div>
                                        </template>
                                    </div>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <div class="premium-input-wrapper">
                                        <label class="premium-input-label">Priority</label>
                                        <select class="premium-input" data-field="Priority__c"
                                            onchange={handleTaskInputChangeCustom}>
                                            <template for:each={priorityOptions} for:item="option">
                                                <option key={option.value} value={option.value}
                                                    selected={option.selected}>{option.label}</option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="premium-input-wrapper">
                                <label class="premium-input-label">Description</label>
                                <textarea class="premium-input" rows="3" data-field="Description__c"
                                    oninput={handleTaskInputChangeCustom}
                                    placeholder="Task details...">{taskForm.Description__c}</textarea>
                            </div>

                            <div class="slds-form-element">
                                <div class="slds-grid slds-grid_vertical-align-center slds-m-bottom_small">
                                    <label class="premium-input-label slds-m-bottom_none slds-m-right_small">Assign
                                        To</label>
                                    <template if:true={errors.assign}>
                                        <div class="input-error-msg slds-m-right_small">Please select an intern</div>
                                    </template>
                                    <div class="slds-col_bump-left">
                                        <label class="slds-checkbox_toggle slds-grid">
                                            <span class="slds-form-element__label slds-m-bottom_none">Select All</span>
                                            <input type="checkbox" checked={isSelectAll} onchange={handleSelectAll} />
                                            <span id="toggle-desc" class="slds-checkbox_faux_container"
                                                aria-live="assertive">
                                                <span class="slds-checkbox_faux"></span>
                                                <span class="slds-checkbox_on"></span>
                                                <span class="slds-checkbox_off"></span>
                                            </span>
                                        </label>
                                    </div>
                                </div>

                                <div class="slds-form-element__control">
                                    <div class="premium-input-wrapper search-wrapper slds-m-bottom_medium">
                                        <span class="search-icon">
                                            <lightning-icon icon-name="utility:search" size="x-small"></lightning-icon>
                                        </span>
                                        <input type="text" class="premium-input search"
                                            placeholder="Search interns by name..." value={searchTerm}
                                            oninput={handleInternSearch} disabled={isSelectAll} />
                                        <template if:true={searchTerm}>
                                            <button class="clear-search-btn" onclick={clearSearch}></button>
                                        </template>
                                    </div>

                                    <template if:true={isSelectAll}>
                                        <div class="all-selected-message">
                                            <lightning-icon icon-name="utility:check" size="small"
                                                class="slds-m-right_x-small"></lightning-icon>
                                            All Interns Selected
                                        </div>
                                    </template>

                                    <template if:false={isSelectAll}>
                                        <template if:true={showInternList}>
                                            <div class="intern-selection-list">
                                                <template for:each={taskInternOptions} for:item="intern">
                                                    <label key={intern.Id} class={intern.cardClass}>
                                                        <input type="radio" name="intern_select" value={intern.Id}
                                                            checked={intern.isChecked} onchange={handleInternSelect} />
                                                        <div class="intern-avatar">{intern.initials}</div>
                                                        <div class="intern-info">
                                                            <span class="intern-name">{intern.Name}</span>
                                                            <span class="intern-role">Intern</span>
                                                        </div>
                                                        <div class="check-indicator">
                                                            <lightning-icon icon-name="utility:check" size="xx-small"
                                                                variant="inverse"></lightning-icon>
                                                        </div>
                                                    </label>
                                                </template>
                                                <template if:false={taskInternOptions.length}>
                                                    <div class="empty-state-message">No interns found matching
                                                        "{searchTerm}"</div>
                                                </template>
                                            </div>
                                        </template>
                                        <template if:false={showInternList}>
                                            <div class="empty-state-message">Type in the search box to find interns...
                                            </div>
                                        </template>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="btn-secondary" onclick={closeTaskModal}>Cancel</button>
                        <button class="btn-primary" onclick={saveTaskRecord}>Save Task</button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

    </div>
</template>